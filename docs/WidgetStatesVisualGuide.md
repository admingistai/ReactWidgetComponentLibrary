# Widget States - Visual Reference Guide

## Visual State Mockups

### Layout States

#### 1. MINIMIZED State
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨  NYT ?  â”‚  â† Compact button (collapsed)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. FLOATING State
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•                               â”‚ â† Header with close
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” [ Ask Anything ] ğŸ¤  NYT    â”‚ â† Search bar
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ Top Stories                  â”‚
â”‚ âœ¨ Breaking News                â”‚ â† Suggestions
â”‚ âœ¨ Generate a new Wordle        â”‚
â”‚                                 â”‚
â”‚        [ More ]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Powered by Claude   âœ¨       â”‚ â† Footer
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. EXPANDED State
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ğŸ” [ Ask Anything ] ğŸ¤      NYT        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚                                             â”‚
â”‚                 (Content Area)              â”‚ â† Larger content area
â”‚                                             â”‚
â”‚                                             â”‚
â”‚                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Powered by Claude   âœ¨              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4. DOCKED State (Bottom)
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â”‚ ğŸ” [ Ask Anything ] ğŸ¤  NYT  â”‚ âœ¨ Suggestionsâ”‚ â† Horizontal layout
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### Content States

#### 1. IDLE State (Default)
```
â”‚ âœ¨ Top Stories                  â”‚
â”‚ âœ¨ Breaking News                â”‚
â”‚ âœ¨ Generate a new Wordle        â”‚
â”‚                                 â”‚
â”‚        [ More ]                 â”‚
```

#### 2. LOADING/SEARCHING State
```
â”‚                                 â”‚
â”‚         âœ¨ (spinning)           â”‚
â”‚   Searching for answers...      â”‚
â”‚                                 â”‚
```

#### 3. RESULTS State
```
â”‚ Found 3 results                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ Results for "weather"        â”‚
â”‚    Latest weather updates...    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ Breaking News Update         â”‚
â”‚    Current conditions...        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ 7-Day Forecast              â”‚
â”‚    Extended outlook...          â”‚
```

#### 4. ERROR State
```
â”‚                                 â”‚
â”‚            âš ï¸                   â”‚
â”‚   Oops! Something went wrong    â”‚
â”‚  Check your internet connection â”‚
â”‚                                 â”‚
â”‚        [ Try Again ]            â”‚
```

#### 5. EMPTY State
```
â”‚                                 â”‚
â”‚            ğŸ”                   â”‚
â”‚  No results found for "xyz"     â”‚
â”‚  Try different keywords or      â”‚
â”‚    browse suggestions           â”‚
â”‚                                 â”‚
â”‚    [ View suggestions ]         â”‚
```

#### 6. VOICE_INPUT State
```
â”‚                                 â”‚
â”‚        â­• (pulsing)            â”‚
â”‚         ğŸ¤                      â”‚
â”‚       Listening...              â”‚
â”‚                                 â”‚
â”‚         [ Stop ]                â”‚
```

## State Transition Flowchart

```mermaid
stateDiagram-v2
    [*] --> MINIMIZED: Initial
    
    MINIMIZED --> FLOATING: Click
    MINIMIZED --> HIDDEN: hide()
    
    FLOATING --> MINIMIZED: Click outside
    FLOATING --> EXPANDED: expand()
    FLOATING --> DOCKED: dock()
    
    EXPANDED --> FLOATING: collapse()
    EXPANDED --> MINIMIZED: minimize()
    
    DOCKED --> FLOATING: undock()
    DOCKED --> MINIMIZED: minimize()
    
    HIDDEN --> MINIMIZED: show()
    HIDDEN --> FLOATING: show() + expand()
    
    note right of FLOATING
        Content states change
        within layout states
    end note
```

## Quick Reference Card

### State Constants
```typescript
// Layout States (Physical form)
WIDGET_STATES = {
  MINIMIZED: 'minimized',
  EXPANDED: 'expanded',
  FLOATING: 'floating',
  DOCKED: 'docked',
  HIDDEN: 'hidden',
}

// Content States (What's shown)
CONTENT_STATES = {
  IDLE: 'idle',
  LOADING: 'loading',
  SEARCHING: 'searching',
  RESULTS: 'results',
  ERROR: 'error',
  VOICE_INPUT: 'voice_input',
  EMPTY: 'empty',
}
```

### Common State Patterns

#### Pattern 1: Search Flow
```typescript
IDLE â†’ user types â†’ FOCUSED â†’ enter â†’ SEARCHING â†’ RESULTS/EMPTY/ERROR
```

#### Pattern 2: Voice Flow
```typescript
IDLE â†’ mic click â†’ VOICE_INPUT â†’ stop/timeout â†’ SEARCHING â†’ RESULTS
```

#### Pattern 3: Error Recovery
```typescript
ERROR â†’ retry â†’ SEARCHING â†’ RESULTS/ERROR
```

#### Pattern 4: Navigation Flow
```typescript
RESULTS â†’ back â†’ IDLE
EMPTY â†’ suggestions â†’ IDLE
```

### State Combination Matrix

| Layout State | Valid Content States | Common Use Case |
|-------------|---------------------|-----------------|
| MINIMIZED | N/A | Widget collapsed |
| FLOATING | All content states | Normal usage |
| EXPANDED | All content states | Full-screen mode |
| DOCKED | IDLE, RESULTS | Quick access bar |
| HIDDEN | N/A | Widget not visible |

### Animation Timings

```typescript
const TRANSITIONS = {
  // Layout transitions
  minimize: 200,      // ms
  expand: 300,        // ms
  dock: 250,          // ms
  
  // Content transitions
  stateChange: 150,   // ms
  fadeIn: 200,        // ms
  fadeOut: 100,       // ms
  
  // Micro-interactions
  hover: 100,         // ms
  click: 50,          // ms
  loading: 1000,      // ms (loop)
};
```

## CSS Classes for States

### Layout State Classes
```css
.widget-minimized { /* Compact form */ }
.widget-floating { /* Default floating */ }
.widget-expanded { /* Full screen */ }
.widget-docked { /* Edge attached */ }
.widget-hidden { /* Display: none */ }
```

### Content State Classes
```css
.content-idle { /* Default view */ }
.content-loading { /* Loading spinner */ }
.content-results { /* Results list */ }
.content-error { /* Error message */ }
.content-empty { /* No results */ }
.content-voice { /* Voice input */ }
```

### State Transition Classes
```css
.state-entering { /* Fade in */ }
.state-exiting { /* Fade out */ }
.state-transition { /* Smooth transition */ }
```

## Component Mapping

### State â†’ Component Map
```typescript
const STATE_COMPONENTS = {
  [CONTENT_STATES.IDLE]: IdleState,
  [CONTENT_STATES.LOADING]: LoadingState,
  [CONTENT_STATES.SEARCHING]: LoadingState,
  [CONTENT_STATES.RESULTS]: ResultsState,
  [CONTENT_STATES.ERROR]: ErrorState,
  [CONTENT_STATES.EMPTY]: EmptyState,
  [CONTENT_STATES.VOICE_INPUT]: VoiceInputState,
};

// Usage
const CurrentState = STATE_COMPONENTS[contentState];
return <CurrentState {...props} />;
```

## State Management Checklist

### Before Adding a New State

- [ ] Is it a layout state or content state?
- [ ] What triggers entry to this state?
- [ ] What are the exit conditions?
- [ ] What data does this state need?
- [ ] Which other states can it transition to?
- [ ] Does it need animation?
- [ ] What happens on error?
- [ ] How does it look on mobile?

### Implementation Checklist

- [ ] Add constant to `constants.ts`
- [ ] Create state component
- [ ] Add to state reducer/handler
- [ ] Update transition logic
- [ ] Add CSS classes
- [ ] Write tests
- [ ] Update documentation
- [ ] Add to visual guide

## Mobile Responsive States

### Minimized (Mobile)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ NYT  â”‚ â† Smaller, bottom-right
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Floating (Mobile)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” [    ] ğŸ¤   â”‚ â† Full width
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ Suggestion 1 â”‚
â”‚ âœ¨ Suggestion 2 â”‚ â† Fewer items
â”‚    [ More ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Powered by âœ¨   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Expanded (Mobile) = Full Screen
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚
â”‚   Full Screen   â”‚
â”‚     Content     â”‚
â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Accessibility States

### Focus States
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” [â–ˆAsk Anything ] ğŸ¤  NYT    â”‚ â† Input focused (cursor)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ Top Stories â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â† Item focused (outline)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Screen Reader Announcements
```typescript
// Announce state changes
<div role="status" aria-live="polite">
  {contentState === CONTENT_STATES.LOADING && "Searching..."}
  {contentState === CONTENT_STATES.RESULTS && `Found ${results.length} results`}
  {contentState === CONTENT_STATES.ERROR && "Error occurred, press Enter to retry"}
</div>
```

## Debug View

### State Inspector Component
```typescript
// Development only
{process.env.NODE_ENV === 'development' && (
  <div className="state-debug">
    Layout: {widget.state}
    Content: {contentState}
    Search: {searchValue}
    Results: {results.length}
    Error: {error?.message || 'none'}
  </div>
)}
```

### Console State Logger
```typescript
useEffect(() => {
  console.log('State Change:', {
    layout: widget.state,
    content: contentState,
    timestamp: Date.now(),
  });
}, [widget.state, contentState]);
```

## Common Issues & Solutions

| Issue | Cause | Solution |
|-------|-------|----------|
| State stuck in LOADING | API timeout | Add timeout handler |
| Can't exit ERROR | Missing reset | Add IDLE transition |
| Voice not stopping | No cleanup | Clear timeouts |
| Results disappear | State overwrite | Check transition logic |
| Animation glitch | Missing key | Add unique keys |

## Performance Tips

1. **Lazy Load States**
   - Only load ResultsState when needed
   - Code-split heavy components

2. **Memoize Renders**
   - Use React.memo for state components
   - Memoize expensive calculations

3. **Debounce Inputs**
   - Debounce search input
   - Throttle scroll events

4. **Optimize Animations**
   - Use CSS transforms
   - Avoid layout thrashing
   - Use will-change sparingly

## Testing Matrix

| State | Test Cases |
|-------|------------|
| MINIMIZED | Click expands, Persists position |
| FLOATING | Draggable, Click outside |
| LOADING | Shows spinner, Timeout handling |
| RESULTS | Displays items, Click handling |
| ERROR | Shows message, Retry works |
| VOICE | Animation plays, Stop works |

## Conclusion

This visual guide provides a quick reference for:
- How each state looks
- Valid state transitions
- Implementation patterns
- Common pitfalls

Use this alongside the architecture and implementation guides to build robust multi-state widgets.